# resource_availability for Quali Utilities
The purpose of this container is to run as a cron-job that does the following:
1.  Generate a list of devices based on the Family/Model entries in the config file.
2.  Generate a time range based on the current time + the start & end time offsets in the config file.
3.  Query all reservations per individual resource based on the generated time range.
4.  Generate a JSON file with formatted date for each reservation, per resource, for use with AmChart's gantt chart.

# Config
+ `cloudshell_server`: hostname (or IP) of the CloudShell Server to query against

+ `cloudshell_user`: CloudShell user name, should be an admin to ensure access all domains (service account ok)

+ `cloudshell_password`: BASE64 User's corresponding password

+ `cloudshell_domain`: Domain in to which to query (Global recommended)

+ `start_offset`: The amount of time (in seconds) to offset the query start time vs. the current time (Negative numbers allowed)
    - Minus 7 days would be entered as `-604800` (-7 x 24 x 60 x 60)

+ `end_offset`: The amount of time (in seconds) to offset the query end time vs. the current time (Negative numbers allowed)
    - Plus 14 days would be entered as `1209000` (14 x 24 x 60 x 60)

+ `output_file`: The full path and name of the JSON file to be generated by the job.

+ `family_model_list`: A list of entries for the query.  Will return all devices with in that specified entry, along with a list of reservations associated with each device
    - Each entry is `<FamilyName>:<ModelName>` where either can be omitted, but not both.
    - _Acceptable: `<FamilyName>:` or `<FamilyName>:<ModelName>`_
    - _Not Recommended (But Valid): `:<ModelName>`_
    - All times generated for reservations are in GMT
    - Format `YYYY-MM-DD HH:MM` (24 Hour Clock)
    
# How to use this repo for development
This container is a component of the Quali Utilities stack.

### docker-compose
    $ docker-compose build
    $ docker-compose up

### Manually
    $ docker build -t arueth/quali_utils_cron:latest .
    $ docker container run \
        -d \
        --name quali_utils_cron \
        -v qualiutils_cron_configs:/usr/src/script/config \
        -v qualiutils_data:/usr/src/script/data \
        arueth/quali-utils-cron
